import{d as N,z as _,ao as h,ae as K,r as m,a as B,l as F,f as n,i as t,m as P,p as I,D as j,s as a,E as u,F as c,M as p,G as v,H as y,U as V,K as q,L as T,j as E,J as G,e as r}from"./index-C3vCaKLz.js";const R={class:"panel"},H={class:"flex items-center justify-between mb-5"},J={key:0,class:"flex justify-center items-center min-h-[400px]"},O={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Q={class:"mb-4"},W={key:0,class:"text-red-500 text-xs mt-1"},X={class:"mb-4"},Y={key:0,class:"text-red-500 text-xs mt-1"},Z={class:"mb-4"},$=["value"],ee={key:0,class:"text-red-500 text-xs mt-1"},te={class:"mb-4"},oe={key:0,class:"text-red-500 text-xs mt-1"},ie={class:"mb-4"},se={class:"relative"},le={key:0,class:"text-red-500 text-xs mt-1"},ne={class:"mb-4"},re={class:"mb-4"},ae={class:"flex items-center"},ue={class:"ml-2"},de={class:"text-xs text-gray-500 mt-1"},ve={class:"mb-4"},me={class:"inline-flex"},ce={class:"mb-4 sm:col-span-2"},pe={class:"flex justify-end gap-4 mt-4"},ye=["disabled"],fe={class:"flex items-center gap-2"},ge=N({__name:"edit",setup(be){const b=_(),L=h(),x=K(),S=m(!1),w=m(!1),i=m({}),k=m(null),d=m({show:!1,message:"",type:"info"}),o=m({id:"",code:"",name:"",categoryId:"",unit:"adet",unitPrice:0,minStockLevel:0,totalStock:0,description:"",isActive:!0}),A=m(x.getCategories);B(async()=>{var e;const l=(e=L.params.id)==null?void 0:e.toString();l?await C(l):b.push("/inventory/products")});const C=async l=>{S.value=!0;try{const e=x.getProducts.find(g=>g.id===l);if(!e){f("Ürün bulunamadı. Ürün listesine yönlendiriliyorsunuz.","error"),setTimeout(()=>{b.push("/inventory/products")},2e3);return}o.value={id:e.id,code:e.code,name:e.name,categoryId:e.categoryId,unit:e.unit,unitPrice:e.unitPrice,minStockLevel:e.minStockLevel,totalStock:e.totalStock||0,description:e.description||"",isActive:e.isActive},k.value={...o.value}}catch(e){console.error("Ürün yüklenirken hata oluştu:",e),f("Ürün yüklenirken bir hata oluştu","error"),b.push("/inventory/products")}finally{S.value=!1}},z=()=>(i.value={},o.value.code.trim()||(i.value.code="Ürün kodu zorunludur"),o.value.name.trim()||(i.value.name="Ürün adı zorunludur"),o.value.categoryId||(i.value.categoryId="Kategori seçmelisiniz"),o.value.unit||(i.value.unit="Birim seçmelisiniz"),o.value.unitPrice<=0&&(i.value.unitPrice="Birim fiyat 0'dan büyük olmalıdır"),Object.keys(i.value).length===0),U=()=>{k.value&&(o.value={...k.value}),f("Form değişiklikleri iptal edildi","info")},f=(l,e="info")=>{d.value={show:!0,message:l,type:e},setTimeout(()=>{d.value.show=!1},3e3)},D=()=>{d.value.show=!1},M=async()=>{if(z()){w.value=!0;try{const l={name:o.value.name,categoryId:o.value.categoryId,unit:o.value.unit,unitPrice:o.value.unitPrice,minStockLevel:o.value.minStockLevel,description:o.value.description,isActive:o.value.isActive};x.updateProduct(o.value.id,l),f("Ürün başarıyla güncellendi","success"),k.value={...o.value},setTimeout(()=>{b.push("/inventory/products")},1500)}catch(l){console.error("Ürün güncellenirken hata oluştu:",l),f("Ürün güncellenirken bir hata oluştu","error")}finally{w.value=!1}}};return(l,e)=>{const g=F("router-link");return r(),n("div",null,[t("div",R,[t("div",H,[e[10]||(e[10]=t("h5",{class:"font-semibold text-lg dark:text-white-light"},"Ürün Düzenle",-1)),P(g,{to:"/inventory/products",class:"btn btn-outline-primary"},{default:I(()=>e[9]||(e[9]=[t("i",{class:"las la-arrow-left"},null,-1),a(" Geri Dön ")])),_:1})]),S.value?(r(),n("div",J,e[11]||(e[11]=[t("div",{class:"animate-spin rounded-full h-10 w-10 border-4 border-primary border-l-transparent"},null,-1)]))):(r(),n("form",{key:1,onSubmit:j(M,["prevent"])},[t("div",O,[t("div",Q,[e[12]||(e[12]=t("label",{for:"productCode"},[a("Ürün Kodu "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{id:"productCode",type:"text",class:p(["form-input",{"border-red-500":i.value.code}]),"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.code=s),required:"",readonly:""},null,2),[[c,o.value.code]]),i.value.code?(r(),n("p",W,v(i.value.code),1)):y("",!0)]),t("div",X,[e[13]||(e[13]=t("label",{for:"productName"},[a("Ürün Adı "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{id:"productName",type:"text",class:p(["form-input",{"border-red-500":i.value.name}]),"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.name=s),required:""},null,2),[[c,o.value.name]]),i.value.name?(r(),n("p",Y,v(i.value.name),1)):y("",!0)]),t("div",Z,[e[15]||(e[15]=t("label",{for:"category"},[a("Kategori "),t("span",{class:"text-red-500"},"*")],-1)),u(t("select",{id:"category",class:p(["form-select",{"border-red-500":i.value.categoryId}]),"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.categoryId=s),required:""},[e[14]||(e[14]=t("option",{value:""},"Kategori Seçiniz",-1)),(r(!0),n(q,null,T(A.value,s=>(r(),n("option",{key:s.id,value:s.id},v(s.name),9,$))),128))],2),[[V,o.value.categoryId]]),i.value.categoryId?(r(),n("p",ee,v(i.value.categoryId),1)):y("",!0)]),t("div",te,[e[17]||(e[17]=t("label",{for:"unit"},[a("Birim "),t("span",{class:"text-red-500"},"*")],-1)),u(t("select",{id:"unit",class:p(["form-select",{"border-red-500":i.value.unit}]),"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.unit=s),required:""},e[16]||(e[16]=[E('<option value="adet">Adet</option><option value="kg">Kilogram</option><option value="lt">Litre</option><option value="mt">Metre</option><option value="kutu">Kutu</option><option value="paket">Paket</option>',6)]),2),[[V,o.value.unit]]),i.value.unit?(r(),n("p",oe,v(i.value.unit),1)):y("",!0)]),t("div",ie,[e[19]||(e[19]=t("label",{for:"unitPrice"},[a("Birim Fiyat "),t("span",{class:"text-red-500"},"*")],-1)),t("div",se,[u(t("input",{id:"unitPrice",type:"number",step:"0.01",class:p(["form-input pl-8",{"border-red-500":i.value.unitPrice}]),"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.unitPrice=s),required:""},null,2),[[c,o.value.unitPrice]]),e[18]||(e[18]=t("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"},"₺",-1))]),i.value.unitPrice?(r(),n("p",le,v(i.value.unitPrice),1)):y("",!0)]),t("div",ne,[e[20]||(e[20]=t("label",{for:"minStockLevel"},"Minimum Stok Seviyesi",-1)),u(t("input",{id:"minStockLevel",type:"number",class:"form-input","onUpdate:modelValue":e[5]||(e[5]=s=>o.value.minStockLevel=s),min:"0"},null,512),[[c,o.value.minStockLevel]])]),t("div",re,[e[24]||(e[24]=t("label",{for:"currentStock"},"Mevcut Stok",-1)),t("div",ae,[u(t("input",{id:"currentStock",type:"number",class:"form-input bg-gray-100","onUpdate:modelValue":e[6]||(e[6]=s=>o.value.totalStock=s),readonly:""},null,512),[[c,o.value.totalStock]]),t("span",ue,v(o.value.unit),1)]),t("p",de,[e[22]||(e[22]=a(" Stok miktarını değiştirmek için ")),P(g,{to:"/inventory/movements",class:"text-blue-500 hover:underline"},{default:I(()=>e[21]||(e[21]=[a(" stok hareketi ")])),_:1}),e[23]||(e[23]=a(" ekleyin. "))])]),t("div",ve,[e[26]||(e[26]=t("label",{class:"block mb-2"},"Durum",-1)),t("label",me,[u(t("input",{type:"checkbox",class:"form-checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>o.value.isActive=s)},null,512),[[G,o.value.isActive]]),e[25]||(e[25]=t("span",{class:"ml-2"},"Aktif",-1))])]),t("div",ce,[e[27]||(e[27]=t("label",{for:"description"},"Açıklama",-1)),u(t("textarea",{id:"description",class:"form-textarea",rows:"3","onUpdate:modelValue":e[8]||(e[8]=s=>o.value.description=s)},null,512),[[c,o.value.description]])])]),t("div",pe,[t("button",{type:"button",class:"btn btn-outline-danger",onClick:U}," Değişiklikleri İptal Et "),t("button",{type:"submit",class:"btn btn-primary",disabled:w.value}," Değişiklikleri Kaydet ",8,ye)])],32))]),d.value.show?(r(),n("div",{key:0,class:p(["fixed top-4 right-4 p-4 rounded shadow-md z-50 transition-all duration-300",{"bg-green-500 text-white":d.value.type==="success","bg-red-500 text-white":d.value.type==="error","bg-blue-500 text-white":d.value.type==="info"}])},[t("div",fe,[t("span",null,v(d.value.message),1),t("button",{class:"ml-4 text-white hover:text-gray-200",onClick:D},e[28]||(e[28]=[t("i",{class:"las la-times"},null,-1)]))])],2)):y("",!0)])}}});export{ge as default};
